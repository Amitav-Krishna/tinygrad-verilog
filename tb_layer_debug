#! /usr/bin/vvp
:ivl_version "12.0 (stable)";
:ivl_delay_selection "TYPICAL";
:vpi_time_precision + 0;
:vpi_module "/usr/lib64/ivl/system.vpi";
:vpi_module "/usr/lib64/ivl/vhdl_sys.vpi";
:vpi_module "/usr/lib64/ivl/vhdl_textio.vpi";
:vpi_module "/usr/lib64/ivl/v2005_math.vpi";
:vpi_module "/usr/lib64/ivl/va_math.vpi";
:vpi_module "/usr/lib64/ivl/v2009.vpi";
S_0x560a3a802de0 .scope package, "$unit" "$unit" 2 1;
 .timescale 0 0;
S_0x560a3a802f70 .scope module, "tb_layer_debug" "tb_layer_debug" 3 1;
 .timescale 0 0;
v0x560a3a82cb50_0 .var/s "b_vals", 15 0;
v0x560a3a82cc30_0 .var "clk", 0 0;
v0x560a3a82ccf0_0 .net "done", 0 0, v0x560a3a82c2d0_0;  1 drivers
v0x560a3a82cd90_0 .var "start", 0 0;
v0x560a3a82ce30_0 .var/s "w_vals", 15 0;
v0x560a3a82ced0_0 .var/s "x_vals", 15 0;
v0x560a3a82cf70_0 .net/s "y", 15 0, L_0x560a3a83d800;  1 drivers
S_0x560a3a7b8490 .scope module, "uut" "layer" 3 15, 4 1 0, S_0x560a3a802f70;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "start";
    .port_info 2 /INPUT 16 "x";
    .port_info 3 /INPUT 16 "w";
    .port_info 4 /INPUT 16 "b";
    .port_info 5 /OUTPUT 16 "y";
    .port_info 6 /OUTPUT 1 "done";
P_0x560a3a7ec590 .param/l "M" 0 4 3, +C4<00000000000000000000000000000001>;
P_0x560a3a7ec5d0 .param/l "N" 0 4 2, +C4<00000000000000000000000000000001>;
L_0x560a3a83d800 .functor BUFZ 16, L_0x560a3a83d640, C4<0000000000000000>, C4<0000000000000000>, C4<0000000000000000>;
v0x560a3a82bf30_0 .net/s "activations", 15 0, L_0x560a3a83d640;  1 drivers
v0x560a3a82c010_0 .net/s "b", 15 0, v0x560a3a82cb50_0;  1 drivers
v0x560a3a82c120_0 .net "clk", 0 0, v0x560a3a82cc30_0;  1 drivers
v0x560a3a82c210_0 .var "count", 0 0;
v0x560a3a82c2d0_0 .var "done", 0 0;
v0x560a3a82c3e0_0 .net "start", 0 0, v0x560a3a82cd90_0;  1 drivers
v0x560a3a82c4a0_0 .var "start_delayed", 0 0;
v0x560a3a82c590_0 .var "start_delayed2", 0 0;
v0x560a3a82c650_0 .net/s "w", 15 0, v0x560a3a82ce30_0;  1 drivers
v0x560a3a82c730_0 .var/s "w_vals", 15 0;
v0x560a3a82c7f0_0 .net/s "x", 15 0, v0x560a3a82ced0_0;  1 drivers
v0x560a3a82c8d0_0 .var/s "x_val", 15 0;
v0x560a3a82c990_0 .net/s "y", 15 0, L_0x560a3a83d800;  alias, 1 drivers
E_0x560a3a7eebc0 .event posedge, v0x560a3a82af00_0;
S_0x560a3a7fd520 .scope generate, "genblk1[0]" "genblk1[0]" 4 26, 4 26 0, S_0x560a3a7b8490;
 .timescale 0 0;
P_0x560a3a7fd700 .param/l "i" 1 4 26, +C4<00>;
S_0x560a3a7fd7a0 .scope module, "neuron_inst" "neuron" 4 27, 5 1 0, S_0x560a3a7fd520;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "start";
    .port_info 2 /INPUT 16 "x";
    .port_info 3 /INPUT 16 "w";
    .port_info 4 /INPUT 16 "b";
    .port_info 5 /OUTPUT 16 "activation";
    .port_info 6 /OUTPUT 1 "done";
P_0x560a3a7fd930 .param/l "N" 0 5 2, +C4<00000000000000000000000000000001>;
v0x560a3a82b670_0 .net/s "acc", 15 0, v0x560a3a82ae40_0;  1 drivers
v0x560a3a82b750_0 .net/s "activation", 15 0, L_0x560a3a83d640;  alias, 1 drivers
v0x560a3a82b860_0 .net/s "b", 15 0, v0x560a3a82cb50_0;  alias, 1 drivers
v0x560a3a82b900_0 .net "clk", 0 0, v0x560a3a82cc30_0;  alias, 1 drivers
v0x560a3a82b9d0_0 .net "done", 0 0, L_0x560a3a7ee7d0;  1 drivers
v0x560a3a82bac0_0 .net "done_mac", 0 0, v0x560a3a82b090_0;  1 drivers
L_0x7f15ea3c5018 .functor BUFT 1, C4<0>, C4<0>, C4<0>, C4<0>;
v0x560a3a82bbb0_0 .net "rst", 0 0, L_0x7f15ea3c5018;  1 drivers
v0x560a3a82bc50_0 .net "start", 0 0, v0x560a3a82c4a0_0;  1 drivers
v0x560a3a82bd20_0 .net/s "w", 15 0, v0x560a3a82c730_0;  1 drivers
v0x560a3a82bdc0_0 .net/s "x", 15 0, v0x560a3a82c8d0_0;  1 drivers
S_0x560a3a7f9cb0 .scope module, "activation_inst" "activation" 5 29, 6 1 0, S_0x560a3a7fd7a0;
 .timescale 0 0;
    .port_info 0 /INPUT 16 "weight_product";
    .port_info 1 /INPUT 16 "b";
    .port_info 2 /INPUT 1 "start";
    .port_info 3 /OUTPUT 16 "activation";
    .port_info 4 /OUTPUT 1 "done";
L_0x560a3a7ee7d0 .functor BUFZ 1, v0x560a3a82b090_0, C4<0>, C4<0>, C4<0>;
v0x560a3a829ca0_0 .net/s "activation", 15 0, L_0x560a3a83d640;  alias, 1 drivers
v0x560a3a829d60_0 .net/s "b", 15 0, v0x560a3a82cb50_0;  alias, 1 drivers
v0x560a3a829e20_0 .net "done", 0 0, L_0x560a3a7ee7d0;  alias, 1 drivers
v0x560a3a829ec0_0 .net/s "preactivation", 15 0, L_0x560a3a82d410;  1 drivers
v0x560a3a829fb0_0 .net "start", 0 0, v0x560a3a82b090_0;  alias, 1 drivers
v0x560a3a82a0a0_0 .net/s "weight_product", 15 0, v0x560a3a82ae40_0;  alias, 1 drivers
L_0x560a3a82d410 .arith/sum 16, v0x560a3a82ae40_0, v0x560a3a82cb50_0;
S_0x560a3a7f9e90 .scope module, "relu_inst" "relu" 6 11, 7 1 0, S_0x560a3a7f9cb0;
 .timescale 0 0;
    .port_info 0 /INPUT 16 "y";
    .port_info 1 /OUTPUT 16 "activation";
v0x560a3a7b9580_0 .net *"_ivl_1", 0 0, L_0x560a3a82d590;  1 drivers
L_0x7f15ea3c5060 .functor BUFT 1, C4<0000000000000000>, C4<0>, C4<0>, C4<0>;
v0x560a3a7f4110_0 .net/2u *"_ivl_2", 15 0, L_0x7f15ea3c5060;  1 drivers
v0x560a3a829aa0_0 .net/s "activation", 15 0, L_0x560a3a83d640;  alias, 1 drivers
v0x560a3a829b60_0 .net/s "y", 15 0, L_0x560a3a82d410;  alias, 1 drivers
L_0x560a3a82d590 .part L_0x560a3a82d410, 15, 1;
L_0x560a3a83d640 .functor MUXZ 16, L_0x560a3a82d410, L_0x7f15ea3c5060, L_0x560a3a82d590, C4<>;
S_0x560a3a82a220 .scope module, "mac_inst" "mac" 5 19, 8 12 0, S_0x560a3a7fd7a0;
 .timescale 0 0;
    .port_info 0 /INPUT 1 "clk";
    .port_info 1 /INPUT 1 "rst";
    .port_info 2 /INPUT 1 "start";
    .port_info 3 /INPUT 16 "x";
    .port_info 4 /INPUT 16 "w";
    .port_info 5 /OUTPUT 16 "acc";
    .port_info 6 /OUTPUT 1 "done";
P_0x560a3a82a420 .param/l "N" 0 8 13, +C4<00000000000000000000000000000001>;
v0x560a3a82ae40_0 .var/s "acc", 15 0;
v0x560a3a82af00_0 .net "clk", 0 0, v0x560a3a82cc30_0;  alias, 1 drivers
v0x560a3a82afa0_0 .var "count", 0 0;
v0x560a3a82b090_0 .var "done", 0 0;
v0x560a3a82b160_0 .net/s "product", 15 0, L_0x560a3a82d2a0;  1 drivers
v0x560a3a82b250_0 .net "rst", 0 0, L_0x7f15ea3c5018;  alias, 1 drivers
v0x560a3a82b2f0_0 .net "start", 0 0, v0x560a3a82c4a0_0;  alias, 1 drivers
v0x560a3a82b3b0_0 .net/s "w", 15 0, v0x560a3a82c730_0;  alias, 1 drivers
v0x560a3a82b4a0_0 .net/s "x", 15 0, v0x560a3a82c8d0_0;  alias, 1 drivers
E_0x560a3a7ee630 .event posedge, v0x560a3a82b250_0, v0x560a3a82af00_0;
S_0x560a3a82a590 .scope module, "mul_inst" "fixed_mul" 8 31, 9 8 0, S_0x560a3a82a220;
 .timescale 0 0;
    .port_info 0 /INPUT 16 "a";
    .port_info 1 /INPUT 16 "b";
    .port_info 2 /OUTPUT 16 "result";
v0x560a3a82a800_0 .net/s *"_ivl_0", 31 0, L_0x560a3a82d060;  1 drivers
v0x560a3a82a900_0 .net/s *"_ivl_2", 31 0, L_0x560a3a82d100;  1 drivers
v0x560a3a82a9e0_0 .net/s "a", 15 0, v0x560a3a82c8d0_0;  alias, 1 drivers
v0x560a3a82aad0_0 .net/s "b", 15 0, v0x560a3a82c730_0;  alias, 1 drivers
v0x560a3a82abb0_0 .net/s "full_product", 31 0, L_0x560a3a82d1d0;  1 drivers
v0x560a3a82ace0_0 .net/s "result", 15 0, L_0x560a3a82d2a0;  alias, 1 drivers
L_0x560a3a82d060 .extend/s 32, v0x560a3a82c8d0_0;
L_0x560a3a82d100 .extend/s 32, v0x560a3a82c730_0;
L_0x560a3a82d1d0 .arith/mult 32, L_0x560a3a82d060, L_0x560a3a82d100;
L_0x560a3a82d2a0 .part L_0x560a3a82d1d0, 8, 16;
    .scope S_0x560a3a82a220;
T_0 ;
    %wait E_0x560a3a7ee630;
    %load/vec4 v0x560a3a82b250_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_0.0, 8;
    %pushi/vec4 0, 0, 16;
    %assign/vec4 v0x560a3a82ae40_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x560a3a82afa0_0, 0;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x560a3a82b090_0, 0;
    %jmp T_0.1;
T_0.0 ;
    %load/vec4 v0x560a3a82b2f0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_0.2, 8;
    %load/vec4 v0x560a3a82b160_0;
    %assign/vec4 v0x560a3a82ae40_0, 0;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v0x560a3a82afa0_0, 0;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v0x560a3a82b090_0, 0;
    %jmp T_0.3;
T_0.2 ;
    %load/vec4 v0x560a3a82afa0_0;
    %pad/u 32;
    %cmpi/u 0, 0, 32;
    %flag_or 5, 4; GT is !LE
    %flag_inv 5;
    %flag_get/vec4 5;
    %jmp/0 T_0.6, 5;
    %load/vec4 v0x560a3a82afa0_0;
    %pad/u 32;
    %cmpi/u 1, 0, 32;
    %flag_get/vec4 5;
    %and;
T_0.6;
    %flag_set/vec4 8;
    %jmp/0xz  T_0.4, 8;
    %load/vec4 v0x560a3a82ae40_0;
    %load/vec4 v0x560a3a82b160_0;
    %add;
    %assign/vec4 v0x560a3a82ae40_0, 0;
    %load/vec4 v0x560a3a82afa0_0;
    %pad/u 2;
    %addi 1, 0, 2;
    %pad/u 1;
    %assign/vec4 v0x560a3a82afa0_0, 0;
    %load/vec4 v0x560a3a82afa0_0;
    %pad/u 32;
    %pushi/vec4 0, 0, 32;
    %cmp/e;
    %flag_get/vec4 4;
    %assign/vec4 v0x560a3a82b090_0, 0;
    %jmp T_0.5;
T_0.4 ;
    %load/vec4 v0x560a3a82b090_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_0.7, 8;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x560a3a82b090_0, 0;
T_0.7 ;
T_0.5 ;
T_0.3 ;
T_0.1 ;
    %jmp T_0;
    .thread T_0;
    .scope S_0x560a3a7b8490;
T_1 ;
    %wait E_0x560a3a7eebc0;
    %load/vec4 v0x560a3a82c3e0_0;
    %assign/vec4 v0x560a3a82c4a0_0, 0;
    %load/vec4 v0x560a3a82c4a0_0;
    %assign/vec4 v0x560a3a82c590_0, 0;
    %load/vec4 v0x560a3a82c3e0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.0, 8;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x560a3a82c210_0, 0;
    %load/vec4 v0x560a3a82c7f0_0;
    %assign/vec4 v0x560a3a82c8d0_0, 0;
    %load/vec4 v0x560a3a82c650_0;
    %assign/vec4 v0x560a3a82c730_0, 0;
    %jmp T_1.1;
T_1.0 ;
    %load/vec4 v0x560a3a82c4a0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.2, 8;
    %pushi/vec4 1, 0, 1;
    %assign/vec4 v0x560a3a82c2d0_0, 0;
    %jmp T_1.3;
T_1.2 ;
    %load/vec4 v0x560a3a82c210_0;
    %pad/u 32;
    %cmpi/u 0, 0, 32;
    %jmp/0xz  T_1.4, 5;
    %load/vec4 v0x560a3a82c210_0;
    %pad/u 2;
    %addi 1, 0, 2;
    %pad/u 1;
    %assign/vec4 v0x560a3a82c210_0, 0;
    %load/vec4 v0x560a3a82c7f0_0;
    %load/vec4 v0x560a3a82c210_0;
    %pad/u 32;
    %addi 1, 0, 32;
    %muli 16, 0, 32;
    %part/u 16;
    %assign/vec4 v0x560a3a82c8d0_0, 0;
    %load/vec4 v0x560a3a82c650_0;
    %load/vec4 v0x560a3a82c210_0;
    %pad/u 32;
    %addi 1, 0, 32;
    %muli 1, 0, 32;
    %muli 16, 0, 32;
    %part/u 16;
    %assign/vec4 v0x560a3a82c730_0, 0;
    %load/vec4 v0x560a3a82c210_0;
    %pad/u 32;
    %addi 1, 0, 32;
    %pushi/vec4 0, 0, 32;
    %cmp/e;
    %flag_get/vec4 4;
    %assign/vec4 v0x560a3a82c2d0_0, 0;
    %jmp T_1.5;
T_1.4 ;
    %load/vec4 v0x560a3a82c2d0_0;
    %flag_set/vec4 8;
    %jmp/0xz  T_1.6, 8;
    %pushi/vec4 0, 0, 1;
    %assign/vec4 v0x560a3a82c2d0_0, 0;
T_1.6 ;
T_1.5 ;
T_1.3 ;
T_1.1 ;
    %jmp T_1;
    .thread T_1;
    .scope S_0x560a3a802f70;
T_2 ;
    %delay 5, 0;
    %load/vec4 v0x560a3a82cc30_0;
    %inv;
    %store/vec4 v0x560a3a82cc30_0, 0, 1;
    %jmp T_2;
    .thread T_2;
    .scope S_0x560a3a802f70;
T_3 ;
    %vpi_call/w 3 28 "$display", "=== Layer Debug Test ===" {0 0 0};
    %pushi/vec4 512, 0, 16;
    %store/vec4 v0x560a3a82ced0_0, 0, 16;
    %pushi/vec4 256, 0, 16;
    %store/vec4 v0x560a3a82ce30_0, 0, 16;
    %pushi/vec4 0, 0, 16;
    %store/vec4 v0x560a3a82cb50_0, 0, 16;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x560a3a82cc30_0, 0, 1;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x560a3a82cd90_0, 0, 1;
    %vpi_call/w 3 37 "$monitor", "t=%0t clk=%b start_d=%b neuron_start=%b neuron_x=%d mac_start=%b mac_count=%d mac_acc=%d", $time, v0x560a3a82cc30_0, v0x560a3a82c4a0_0, v0x560a3a82bc50_0, v0x560a3a82bdc0_0, v0x560a3a82b2f0_0, v0x560a3a82afa0_0, v0x560a3a82ae40_0 {0 0 0};
    %delay 20, 0;
    %pushi/vec4 1, 0, 1;
    %store/vec4 v0x560a3a82cd90_0, 0, 1;
    %delay 10, 0;
    %pushi/vec4 0, 0, 1;
    %store/vec4 v0x560a3a82cd90_0, 0, 1;
    %delay 100, 0;
    %vpi_call/w 3 51 "$finish" {0 0 0};
    %end;
    .thread T_3;
# The file index is used to find the file name in the following table.
:file_names 10;
    "N/A";
    "<interactive>";
    "-";
    "test/tb_layer_debug.v";
    "src/layer.v";
    "src/neuron.v";
    "src/activation.v";
    "src/relu.v";
    "src/mac.v";
    "src/fixed_mul.v";
